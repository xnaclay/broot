#!/bin/bash

include_defconfig () {
  cat buildroot/configs/${1}_defconfig
}

include () {
  if [[ -f ./gendefconfig-lib/${1} ]]; then
    . ./gendefconfig-lib/${1}
  else 
    . ./gendefconfig-configs/${1}
  fi
}

for genconf in $(ls gendefconfig-configs/); do
  OVERLAY=""
  POST_BUILD_SCRIPT=""
  exec >buildroot/configs/broot_${genconf}_defconfig
  echo '# THIS FILE IS GENERATED BY gendefconfig -- DO NOT EDIT --'
  . ./gendefconfig-configs/${genconf}
  echo
  echo "BR2_ROOTFS_OVERLAY=\"${OVERLAY}\""
  echo "BR2_ROOTFS_POST_BUILD_SCRIPT=\"${POST_BUILD_SCRIPT}\""
  echo "BR2_ROOTFS_POST_IMAGE_SCRIPT=\"${POST_IMAGE_SCRIPT}\""
  echo "BR2_ROOTFS_POST_SCRIPT_ARGS=\"${POST_SCRIPT_ARGS}\""
done
